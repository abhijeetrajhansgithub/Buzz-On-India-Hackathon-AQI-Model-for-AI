<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Home Page</title>
    <link rel="stylesheet" href="../static/css/HomeStyles.css">
    <link rel="stylesheet" href="../static/css/popStyle.css">
    <link rel="stylesheet" href="../static/css/ChatBot.css">
    <link rel="stylesheet" href="../static/css/CommunityForum.css">
    <link rel="stylesheet" href="../static/css/Summarizer.css">
    <link rel="stylesheet" href="../static/css/SuggestionsModal.css">
    <style>
        .imp{
            color: maroon;
        }
        .subHeader{
            color:rgb(193, 84, 6);
        }
        .subpara, .graphs{
            display: flex;
            flex-wrap: wrap;
            padding: 2%;
            justify-content: center;

        }
        .main{
            justify-content: center;
            align-items: center;
        }
        .card{
        display: flex;
        flex-direction: column;
        justify-content: center;
         width: 40%;
         background-color: rgba(255, 171, 171, 0.577);
         margin: 7px;
         border-radius: 10px;
         padding: 20px;
         transition: box-shadow 0.3s ease;
         vertical-align: auto;
        }
        .card:hover{
            box-shadow: 3px 7px 7px  rgba(232, 118, 118, 0.577),3px 7px 7px rgba(232, 118, 118, 0.577),3px 7px 7px rgba(232, 118, 118, 0.577);
        }
        
        .graphs figure{
            width: 50%;
            margin: 7px;
            border-radius: 10px;
         
        }
        
    </style>
</head>
<body>
    <center>
        <div class="top">
            <p id="heading"><i>Webai</i> AQI - <i>The Air Quality Monitoring Platform</i></p>
            <h4 style="margin-top: -20px">Your own <i>Pollution Scanner!</i></h4>
        </div>
    </center>

    <div class="container">
        <div class="main">
            <h2>DELHI'S POLLUTION LEVEL ANALYSIS</h2>
            <hr>
            <div class="subpara">
                <figure>
                    <img src="../static/media/AQI%20distribution%20PIE%20CHART.jpg" alt="">
                    <figcaption>
                        Frequency of different AQI levels over the year
                    </figcaption>
                </figure>
                <p>
                pollution levels impact the public health and the economy. High concentrations of pollutants are known to cause severe <b class="imp">respiratory and cardiovascular diseases</b>. Continuously monitoring air quality,hellps the authorities to raise awareness and implement preventive measures to safeguard public health.<br><br>
                <i>Hence we visualize your city's data and trends for the easier understanding about your area's pollution levels for the citizens and authorities</i><br><br>
                <b class="imp">Public Awareness</b> regarding the severity of pollution may encourage behavioral shifts and promoting sustainable practices. <br><br>
                
                Moreover, pollution is a major contributor to <b class="imp">climate change </b>, and tracking pollution levels enables more effective strategies for reducing emissions, aligning with broader climate action goals.</p>
            </div>
            <h2>DELHI</h2>
            <hr>
            <h3 class="subHeader"><li>Analyzing the Harmful components over the years</li></h3> 
                <div class="subpara">
                    <figure>
                        <img src="../static/media/AirQuality%20Time%20series.jpg" alt=""></img>
                        <figcaption>Air Quality Time Series</figcaption>
                    </figure>
                    
                </div>
                <h3 class="imp"><i>OBSERVATIONS</i></h3>
                <div class="subpara">
                    
                    <div class="card">
                        <b class="imp">Dominance of Carbon Monoxide (CO):</b><br>
                        
                        CO levels (blue spikes) dominate the graph, with several spikes exceeding 20,000 µg/m³, indicating severe pollution episodes. CO is a major contributor to Delhi's air pollution.
                    </div>
                    <div class="card">
                        <b class="imp">Moderate Levels of PM2.5 and PM10:</b><br>
                        
                        PM2.5 (purple) and PM10 (red) show consistent but smaller peaks, indicating variability in particulate matter levels, which are harmful to health.<br><br>
                    </div>
                    <div class="card">
                        <b class="imp">Frequent Pollution Peaks:</b><br>
                        
                        Frequent spikes suggest periodic pollution surges, likely due to traffic, weather patterns, or seasonal activities.<br><br>
                    </div>
                    <div class="card">
                        <b class="imp">Seasonal Impact:</b><br>
                        
                        Air quality worsens in winter due to smog and Diwali fireworks, increasing health risks like respiratory and cardiovascular diseases.
                        </div>
                
                
            </div>
            
            
            <h3 class="subHeader"><li>Analyzing 2.5PM vs NO2 Pollution:</li></h3> 
           
            <div class="subpara">
                <figure>
                    <img src="../static/media/Scatter%20plot%20of%20PM2.5%20vs%20NO2.jpg" alt="">
                    <figcaption>Visualizing 2.5PM vs NO2 Pollution:
    
                    </figcaption>
                </figure>
            </div>
            <h3 class="imp"><i>OBSERVATIONS</i></h3>
            <div class="subpara">


                    <div class="card">
                        <b class="imp">Positive Correlation:</b><br>
                        
                        PM2.5 and NO2 increase together, suggesting shared pollution sources like traffic and industry.
                    </div>
                    <div class="card">
                        <b class="imp">Common Pollution Levels: </b><br>
                        
                        Most pollution events fall below 750 µg/m³ for PM2.5 and 200 µg/m³ for NO2.<br><br>
                    </div>
                    <div class="card">
                        <b class="imp">High Pollution Spikes:</b><br>
                        
                        Outliers show extreme pollution events, likely during winter smog or heavy traffic.<br><br>
                    </div>
                
                
            </div>
            <h3 class="subHeader"><li>Analyzing Frequency of different PM10 levels</li></h3> 
            
            <p>
                <div class="subpara">
                    <figure>
                        <img src="../static/media/Histogram%20PM10%20level.jpg" alt=""></img>
                        <figcaption>Histogram depicting frequency of different PM10 levels </figcaption>
                    </figure>
                </div>
                <h3 class="imp"><i>OBSERVATIONS</i></h3>
                <div class="subpara">


                    <div class="card">
                        <b class="imp">High Pollution Episodes:</b><br>
                        
                        The histogram shows occasional spikes in PM10 levels, reaching as high as 2000 units, indicating periods of severe air quality degradation.
                    </div>
                    <div class="card">
                        <b class="imp">Frequent Moderate Pollution</b><br>
                        
                        The highest frequency of PM10 levels falls between 100-150 units, suggesting that moderate pollution levels are common in Delhi.

                        <br><br>
                    </div>
                    
                    <div class="card">
                        <b class="imp">Rare Clean Air:</b><br>
                        
                        Very low PM10 levels (close to 0) are infrequent, showing that air quality rarely reaches "clean" or "safe" standards.<br><br>
                    </div>
                    <div class="card">
                        <b class="imp">Health Implications:</b><br>
                        
                        The right-skewed distribution, with frequent moderate pollution and occasional extreme spikes, indicates ongoing health risks from particulate matter exposure.
                        </div>
                
                
            </div>
            <h3 class="subHeader"><li>Other Relevent Graphs</li></h3>
            <div class="graphs">
                <figure>
                    <img src="../static/media/Scatter%20plot%20of%20PM10%20vs%20CO.jpg" alt="">
                    <figcaption>
                        Relation between the concentration of PM10 and CO 
                    </figcaption>
                </figure>
                <figure>
                    <img src="../static/media/Histogram%20PM2.5%20level.jpg">
                    <figcaption>
                        frequency of different PM2.5 levels over the time 
                    </figcaption>
                </figure>

                
            </div> 

        </div>

        <div class="sidebar">
            <ul>
                <li><a href="{{ url_for('return_home') }}">Home Page</a></li>
                <li><a id="manual_input">Manually Input</a></li>
                <li><a href="{{ url_for('what_are_pollutants') }}">What are pollutants?</a></li>
                <li><a href="{{ url_for('pollution_factors') }}">Pollution Factors</a></li>
                <li ><a id="AQI_update">Get Latest AQI Update</a></li>
                <li id="get_email_update"><a> Enter Email for Update</a></li>
            </ul>
        </div>
    </div>


    <!-- Modal for manual input -->
    <div id="manualInputModal" class="modal">
        <div id="manual-input-modal-content" class="modal-content">
            <span class="close" id="closeManualInput">&times;</span>
            <h2>Give your inputs:</h2>
        <form id="inputForm">

                <label for="co">CO (Carbon Monoxide) Amount:</label><br>
                <input type="text" id="co" name="co" required><br><br>

                <label for="no">NO (Nitric Oxide) amount:</label><br>
                <input type="text" id="no" name="no" required><br><br>

                <label for="no2">NO<sub>2</sub> (Nitrogen Dioxide)</label><br>
                <input type="text" id="no2" name="no2" required><br><br>

                <label for="so2">SO<sub>2</sub> (Sulphur Dioxide)</label><br>
                <input type="text" id="so2" name="so2" required><br><br>

                <label for="o3">O<sub>3</sub> (Ozone)</label><br>
                <input type="text" id="o3" name="o3" required><br><br>

                <label for="nh3">NH<sub>3</sub> (Ammonia)</label><br>
                <input type="text" id="nh3" name="nh3" required><br><br>

                <input id="submit_btn" type="submit" value="Submit">
                <p id="result">Result:<span></span> </p>
            </form>
        </div>
    </div>
    
    <!-- Modal for AQI Update -->
    <div id="AQIupdateModel" class="modal">
        <div class="modal-content">
            <span class="close" id="closeAQIUpdate">&times;</span>
            <h2>Get Latest AQI update</h2>
            <form id="inputForm-for-aqi">
                <center><input id="get-aqi-update-result-button" type="submit" value="GET RESULT!"></center>
                <p id="aqi-update-result"><span></span></p>
            </form>
        </div>
    </div>

    <div id="EnterEmail" class="modal">
        <div class="modal-content">
            <span class="close" id="closeEmail">&times;</span>
            <h3>Now notifications in your MailBox! </h3>
            <form id="inputForm-for-email">
                <br>
                <label for="User_email">Enter your email to receive notifications about the Air Quality</label><br><br>
                <input type="text" id="User_email" name="User_email" required><br><br>
                <center><input id="submit_email_btn" type="submit" value="Submit"></center><br>
                <p id="emailing-result"><span></span> </p>
            </form>
        </div>
    </div>

    <div class="chatbot-icon" id="chatbotIcon">🤖</div>

    <!-- Modal for ChatBot -->
    <div id="chatbotModal" class="modal">
        <div class="modal-contentBOT">
            <span class="close" id="closeModal">&times;</span>
            <h2>Hi there! I'm AirBuddy, here to help you.</h2>
            <h4>What can I assist you with?</h4>
            <div id="conversationHistory" class="conversation-history"></div>
            <label for="userInput"></label><input type="email" id="userInput" placeholder="Enter your Query...">
            <button id="submitBtn">Submit</button>
        </div>
    </div>

    <!-- Community Forum Icon -->
    <div class="community-forum-icon" id="communityForumIcon">🗣️</div>

    <div id="communityForumModal" class="modal">
        <div class="modal-content-forum">
            <span class="close" id="closeForumModal">&times;</span>
            <h2>Welcome to the Community Forum!</h2>
            <h4>How can we help you today?
                <span id="summarizerLabel" class="summarize-label">Summarize</span>
                <!-- Summarizer Popup -->
                <div id="summarizerPopup" class="summarizer-popup">
                    <div id="summarizerText" class="gradient-text">Loading...</div>
                </div>
            </h4>
            <div id="forumConversationHistory" class="forum-conversation-history"></div>
            <label for="forumUserInput"></label>
            <input type="text" id="forumUserInput" placeholder="Ask your question...">
            <button id="forumSubmitBtn">Submit</button>
        </div>
    </div>

    <!-- Suggestions Icon -->
    <div class="suggestions-icon" id="suggestionsIcon">💡</div>

    <!-- Modal Structure -->
    <div id="suggestionsModal" class="suggestions-modal">
        <div class="suggestions-modal-content">
            <span class="suggestions-close" id="suggestions-modalClose">&times;</span>
            <h2>Air Quality Index (AQI) Suggestions</h2>
            <div id="aqiContent">
                <h3>AQI Scale Overview</h3>
                <p>The Air Quality Index (AQI) is a system used to measure and report air quality. The AQI is divided into five categories, each representing a different level of health concern.</p>

                <h4>AQI Level 1: Good (0-50)</h4>
                <p>Air quality is considered satisfactory, and air pollution poses little or no risk. People can continue with normal outdoor activities.</p>
                <h5>Health Effects:</h5>
                <p>None.</p>
                <h5>Solutions:</h5>
                <p>No specific actions needed.</p>

                <h4>AQI Level 2: Moderate (51-100)</h4>
                <p>Air quality is acceptable; however, there may be a concern for some people, particularly those who are unusually sensitive to air pollution.</p>
                <h5>Health Effects:</h5>
                <p>Some people may experience respiratory symptoms.</p>
                <h5>Solutions:</h5>
                <p>Sensitive individuals should consider limiting prolonged outdoor exertion.</p>

                <h4>AQI Level 3: Unhealthy for Sensitive Groups (101-150)</h4>
                <p>Members of sensitive groups may experience health effects. The general public is not likely to be affected.</p>
                <h5>Health Effects:</h5>
                <p>Individuals with respiratory or heart conditions, children, and older adults may experience health effects.</p>
                <h5>Solutions:</h5>
                <p>Limit outdoor activities for sensitive individuals; others may continue normal activities.</p>

                <h4>AQI Level 4: Unhealthy (151-200)</h4>
                <p>Everyone may begin to experience health effects; members of sensitive groups may experience more serious health effects.</p>
                <h5>Health Effects:</h5>
                <p>Increased respiratory symptoms and decreased lung function are possible.</p>
                <h5>Solutions:</h5>
                <p>Avoid outdoor activities and keep windows closed; consider using air purifiers.</p>

                <h4>AQI Level 5: Very Unhealthy (201-300)</h4>
                <p>Health alert: everyone may experience more serious health effects.</p>
                <h5>Health Effects:</h5>
                <p>Increased risk of respiratory effects for everyone.</p>
                <h5>Solutions:</h5>
                <p>Stay indoors, use air purifiers, and limit outdoor activities.</p>
            </div>
        </div>
    </div>



    <script src="../static/js/pop_widow.js"></script> <!-- Ensure this file exists -->
    <script src="../static/js/ChatBot.js"></script>
    <script src="../static/js/EnterEmail.js"></script>
    <script src="../static/js/LatestAQIUpdate.js"></script>
    <script src="../static/js/CommunityForum.js"></script>
    <script src="../static/js/Summarizer.js"></script>
    <script src="../static/js/SuggestionsModal.js"></script>

    <script>

        // Event listener for form submission
document.getElementById('inputForm').addEventListener('submit', async function(event) {
    event.preventDefault();  // Prevent the default form submission

    // Get the input values
    const co = document.getElementById('co').value;
    const no = document.getElementById('no').value;
    const no2 = document.getElementById('no2').value;
    const so2 = document.getElementById('so2').value;
    const o3 = document.getElementById('o3').value;
    const nh3 = document.getElementById('nh3').value;

    // Prepare the data to send to the server
    const inputData = {
        co: co,
        no: no,
        no2: no2,
        so2: so2,
        o3: o3,
        nh3: nh3
    };

    try {
        // Make the fetch request to the backend
        const response = await fetch('/process_input_for_aqi', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify(inputData)
        });

        if (response.ok) {
            // Get JSON response from Flask
            const result = await response.json();

            // Log the result to check its structure
            console.log('Full response from Flask:', result);

            // Display the HTML message directly
            const resultElement = document.getElementById('result');
            if (resultElement) {
                resultElement.innerHTML = result.message;  // Use innerHTML to insert HTML content
                scrollToBottom_aqi()
            } else {
                console.error('Result element not found');
            }
        } else {
            document.getElementById('result').textContent = 'Error occurred while processing';
        }
    } catch (error) {
        console.error('Error:', error);
        document.getElementById('result').textContent = 'Error occurred while processing';
    }
});


    </script>

    <script>
        function scrollToBottom_aqi() {
            // Select the modal content within the modal
            const conversationHistory = document.getElementById('manual-input-modal-content');

            // Check if the element exists to avoid errors
            if (conversationHistory) {
                // Scroll to the bottom of the modal content
                conversationHistory.scrollTop = conversationHistory.scrollHeight;
            } else {
                console.error('Element not found: #manualInputModal .modal-content');
            }
        }
    </script>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
        const modal = document.getElementById('EnterEmail');
        const closeModalBtn = document.getElementById('closeEmail');
        const form = document.getElementById('inputForm-for-email');
        const resultElement = document.getElementById('emailing-result').querySelector('span');

        // Close modal when the "x" button is clicked
        closeModalBtn.onclick = function() {
            modal.style.display = 'none';
        };

        // Handle form submission
        form.addEventListener('submit', function(event) {
            event.preventDefault(); // Prevent form from refreshing the page

            // Get the email input value
            const userEmail = document.getElementById('User_email').value;

            // Send the email to the Flask backend using POST
            fetch('/submit_email', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({ User_email: userEmail })
            })
            .then(response => response.json())
            .then(data => {
                // Display the result (Success or Failed) in the modal
                resultElement.innerHTML = data.message;
                resultElement.style.color = 'green';
            })
            .catch(error => {
                console.error('Error:', error);
                resultElement.innerHTML = 'Failed!';
                resultElement.style.color = 'red';
            });
        });

        // Optional: If you want the modal to close when clicked outside the modal content
        window.onclick = function(event) {
            if (event.target === modal) {
                modal.style.display = 'none';
            }
        };
    });

    </script>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
        const chatbotModal = document.getElementById('chatbotModal');
        const closeModalBtn = document.getElementById('closeModal');

        // Close modal when the "x" button is clicked
        closeModalBtn.onclick = function() {
            chatbotModal.style.display = 'none';
        };

        // Close modal when clicking outside the modal content
        window.onclick = function(event) {
            if (event.target === chatbotModal) {
                chatbotModal.style.display = 'none';
            }
        };
    });

    </script>

</body>
</html>
