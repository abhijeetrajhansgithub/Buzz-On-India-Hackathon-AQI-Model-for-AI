<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Home Page</title>
    <link rel="stylesheet" href="../static/css/HomeStyles.css">
    <link rel="stylesheet" href="../static/css/popStyle.css">
    <link rel="stylesheet" href="../static/css/CommunityForum.css">
    <link rel="stylesheet" href="../static/css/ChatBot.css">
    <link rel="stylesheet" href="../static/css/Summarizer.css">
    <link rel="stylesheet" href="../static/css/SuggestionsModal.css">
    <style>
        .imp{
            color: maroon;
            margin-left: 5%;
        }
        .subHeader{
            color:rgb(193, 84, 6);
        }
        .subpara{
            width: 70%;
            margin-left:8%;     
            background-color: rgba(255, 171, 138, 0.462);    
            padding: 5%;
            border-radius: 20px;
            
            box-shadow: 3px 7px 7px  rgba(232, 118, 118, 0.577),3px 7px 7px rgba(232, 118, 118, 0.577),3px 7px 7px rgba(232, 118, 118, 0.577);


        }
        .subpara {
            transition: transform 0.3s ease;
            {#transition: transform 0.3s ease, text-shadow 0.5s ease;#}
            
        }
        
        .subpara:hover {
                transform:skew(-3deg) translateX(10%);
                {#text-shadow: 0 0 5px #f0a598, 0 0 5px #ff6347#}
          }

        li b{
            color: rgb(9, 57, 84);
        }
    </style>

</head>
<body>
    <center>
        <div class="top">
            <p id="heading"><i>Webai</i> AQI - <i>The Air Quality Monitoring Platform</i></p>
            <h4 style="margin-top: -20px">Your own <i>Pollution Scanner!</i></h4>
        </div>
    </center>

    <div class="container">
        <div class="main">
            <h2 >Reason Behind the rising pollution in Delhi</h2>
            <p>
                
                <h3 class="subHeader "> Emissions:</h3>
                <div class="subpara">
                    <b class="imp">Sources: </b>Cars, trucks, buses, and two-wheelers.<br><br>
                    <b class="imp">Pollutants:</b><br>
                    <ul>
                        <li><b>Nitrogen Dioxide (NO2): </b>High levels due to combustion engines.</li>
                        <li><b>Particulate Matter (PM2.5 and PM10):</b> Dust and soot from vehicle emissions.</li>
                        <li><b>Carbon Monoxide (CO): </b></li>Incomplete combustion of fossil fuels
                    </ul>
                </div>
                <h3 class="subHeader">Industrial Emissions:</h3>
                <div class="subpara">
                    <b class="imp">Sources: </b>Factories, power plants, and construction activities.<br><br>
                    <b class="imp">
                    Pollutants:</b>
                    <ul>
                            <li><b>Sulfur Dioxide (SO2):</b> From burning fossil fuels.</li>
                            <li><b>Particulate Matter (PM2.5 and PM10):</b> Generated from manufacturing activities.</li>
                            <li><b>Volatile Organic Compounds (VOCs):</b> Emitted during industrial processes.</li>
                            <li><b>Particulate Matter (PM2.5 and PM10):</b> Generated from manufacturing activities.</li>
                    </ul>
                </div>
                    <h3 class="subHeader ">Activities:</h3>
                    <div class="subpara">
                    <b class="imp">Sources: </b>Ongoing infrastructure projects and building construction.<br><br>
                    <b class="imp">Pollutants:</b>
                    <ul>
                        <li><b>Particulate Matter (PM2.5 and PM10):</b> Dust from construction sites.</li>
                        <li><b>VOCs: </b>From materials used in construction.</li>
                    </ul>
                 </div>
                    <h3 class="subHeader"> Burning: </h3>
                    <div class="subpara">
                    <b class="imp">Sources:</b> Open burning of garbage and agricultural waste.<br><br>
                    <b class="imp">Pollutants:</b><br>        
                    <ul>
                        <li><b>PM2.5 and PM10:</b> Fine particles from burning organic matter.</li>
                        <li><b>Carbon Dioxide (CO2) and Carbon Monoxide (CO): </b> Resulting from combustion.</li>
                    </ul>
                </div>
                    <h3 class="subHeader">Domestic Sources:</h3>
                    <div class="subpara">
                    <b class="imp">Sources: </b>of solid fuels for cooking and heating.<br><br>
                    <b class="imp">Pollutants:</b>
                    <ul>
                        <li><b>Particulate Matter (PM2.5):</b> From burning biomass and coal.</li> 
                        <li> <b>VOCs:</b> From cleaning agents and paints.
                        Seasonal Trends in Pollution</li>
                    </ul>
                </div>
                <h2 >Seasonal Pollution Trends</h2>
                
                <h3 class="subHeader"> Winter Months (November to February): </h3>
                
                <div class="subpara">
                <b class="imp"><i>Increased Pollution Levels </i></b><br>
                <p>
                    Temperature inversions can trap pollutants close to the ground.
                    Increased burning of agricultural waste in neighboring states.
                    Higher usage of heating fuels and residential cooking during cold weather.
                </p>
            </div>
                <h3 class="subHeader"> Post-Monsoon (September to October):</h3>
                <div class="subpara">
                <b class="imp"><i>Rising Pollution Levels</i></b><br>
                <p>
                    Dust storms can raise PM levels.
                    Construction activities resume post-monsoon, leading to increased dust and emissions.
                    Diwali celebrations (usually in October/November) contribute to a significant rise in air pollution due to firecracker usage.
                </p>
            </div>
                <h3 class="subHeader"> Summer Months (March to June):</h3>
                <div class="subpara">
                <b class="imp"><i>Pollution Levels Tend to Drop</i></b><br>
                <p>
                    Higher wind speeds and rainfall help disperse pollutants.
                    However, some spikes may occur due to dust storms and vehicle emissions.
                    Breakdown of Pollutants Emitted Most by Sources
                </p>
            </div>
                
            </p>
        </div>

        <div class="sidebar">
            <ul>
                <li><a href="{{ url_for('city_report') }}">City Report</a></li>
                <li><a id="manual_input">Manually Input</a></li>
                <li><a href="{{ url_for('what_are_pollutants') }}">What are pollutants?</a></li>
                <li><a href="{{ url_for('return_home') }}">Home Page</a></li>
                <li ><a id="AQI_update">Get Latest AQI Update</a></li>
                <li id="get_email_update"><a> Enter Email for Update</a></li>
            </ul>
        </div>
    </div>


    <!-- Modal for manual input -->
    <div id="manualInputModal" class="modal">
        <div class="modal-content">
            <span class="close" id="closeManualInput">&times;</span>
            <h2>Give your inputs:</h2>
            <form id="inputForm">

                <label for="co">CO (Carbon Monoxide) Amount:</label><br>
                <input type="text" id="co" name="co" required><br><br>

                <label for="no">NO (Nitric Oxide) amount:</label><br>
                <input type="text" id="no" name="no" required><br><br>

                <label for="no2">NO<sub>2</sub> (Nitrogen Dioxide)</label><br>
                <input type="text" id="no2" name="no2" required><br><br>

                <label for="so2">SO<sub>2</sub> (Sulphur Dioxide)</label><br>
                <input type="text" id="so2" name="so2" required><br><br>

                <label for="o3">O<sub>3</sub> (Ozone)</label><br>
                <input type="text" id="o3" name="o3" required><br><br>

                <label for="nh3">NH<sub>3</sub> (Ammonia)</label><br>
                <input type="text" id="nh3" name="nh3" required><br><br>

                <input id="submit_btn" type="submit" value="Submit">
                <p id="result"><span></span> </p>
            </form>
        </div>
    </div>
    <!-- Modal for AQI Update -->
<div id="AQIupdateModel" class="modal">
    <div class="modal-content">
        <span class="close" id="closeAQIUpdate">&times;</span>
        <h2>Get Latest AQI update</h2>
        <form id="inputForm-for-aqi">
            <center><input id="get-aqi-update-result-button" type="submit" value="GET RESULT!"></center>
            <p id="aqi-update-result"><span></span></p>
        </form>
    </div>
</div>

    <div id="EnterEmail" class="modal">
        <div class="modal-content">
            <span class="close" id="closeEmail">&times;</span>
            <h3>Now notifications in your MailBox! </h3>
            <form id="inputForm-for-email">
                <br>
                <label for="User_email">Enter your email to receive notifications about the Air Quality</label><br><br>
                <input type="text" id="User_email" name="User_email" required><br><br>
                <center><input id="submit_email_btn" type="submit" value="Submit"></center><br>
                <p id="emailing-result"><span></span> </p>
            </form>
        </div>
    </div>

    <div class="chatbot-icon" id="chatbotIcon">🤖</div>

    <!-- Modal for ChatBot -->
    <div id="chatbotModal" class="modal">
        <div class="modal-contentBOT">
            <span class="close" id="closeModal">&times;</span>
            <h2>Hi there! I'm AirBuddy, here to help you.</h2>
            <h4>What can I assist you with?</h4>
            <div id="conversationHistory" class="conversation-history"></div>
            <label for="userInput"></label><input type="email" id="userInput" placeholder="Enter your Query...">
            <button id="submitBtn">Submit</button>
        </div>
    </div>

    <!-- Community Forum Icon -->
    <div class="community-forum-icon" id="communityForumIcon">🗣️</div>

    <div id="communityForumModal" class="modal">
        <div class="modal-content-forum">
            <span class="close" id="closeForumModal">&times;</span>
            <h2>Welcome to the Community Forum!</h2>
            <h4>How can we help you today?
                <span id="summarizerLabel" class="summarize-label">Summarize</span>
                <!-- Summarizer Popup -->
                <div id="summarizerPopup" class="summarizer-popup">
                    <div id="summarizerText" class="gradient-text">Loading...</div>
                </div>
            </h4>
            <div id="forumConversationHistory" class="forum-conversation-history"></div>
            <label for="forumUserInput"></label>
            <input type="text" id="forumUserInput" placeholder="Ask your question...">
            <button id="forumSubmitBtn">Submit</button>
        </div>
    </div>

{#    <!-- Summarizer Popup -->#}
{#    <div id="summarizerPopup" class="summarizer-popup">#}
{#        <div id="summarizerText" class="gradient-text">Loading...</div>#}
{#    </div>#}

    <!-- Suggestions Icon -->
    <div class="suggestions-icon" id="suggestionsIcon">💡</div>

    <!-- Modal Structure -->
    <div id="suggestionsModal" class="suggestions-modal">
        <div class="suggestions-modal-content">
            <span class="suggestions-close" id="suggestions-modalClose">&times;</span>
            <h2>Air Quality Index (AQI) Suggestions</h2>
            <div id="aqiContent">
                <h3>AQI Scale Overview</h3>
                <p>The Air Quality Index (AQI) is a system used to measure and report air quality. The AQI is divided into five categories, each representing a different level of health concern.</p>

                <h4>AQI Level 1: Good (0-50)</h4>
                <p>Air quality is considered satisfactory, and air pollution poses little or no risk. People can continue with normal outdoor activities.</p>
                <h5>Health Effects:</h5>
                <p>None.</p>
                <h5>Solutions:</h5>
                <p>No specific actions needed.</p>

                <h4>AQI Level 2: Moderate (51-100)</h4>
                <p>Air quality is acceptable; however, there may be a concern for some people, particularly those who are unusually sensitive to air pollution.</p>
                <h5>Health Effects:</h5>
                <p>Some people may experience respiratory symptoms.</p>
                <h5>Solutions:</h5>
                <p>Sensitive individuals should consider limiting prolonged outdoor exertion.</p>

                <h4>AQI Level 3: Unhealthy for Sensitive Groups (101-150)</h4>
                <p>Members of sensitive groups may experience health effects. The general public is not likely to be affected.</p>
                <h5>Health Effects:</h5>
                <p>Individuals with respiratory or heart conditions, children, and older adults may experience health effects.</p>
                <h5>Solutions:</h5>
                <p>Limit outdoor activities for sensitive individuals; others may continue normal activities.</p>

                <h4>AQI Level 4: Unhealthy (151-200)</h4>
                <p>Everyone may begin to experience health effects; members of sensitive groups may experience more serious health effects.</p>
                <h5>Health Effects:</h5>
                <p>Increased respiratory symptoms and decreased lung function are possible.</p>
                <h5>Solutions:</h5>
                <p>Avoid outdoor activities and keep windows closed; consider using air purifiers.</p>

                <h4>AQI Level 5: Very Unhealthy (201-300)</h4>
                <p>Health alert: everyone may experience more serious health effects.</p>
                <h5>Health Effects:</h5>
                <p>Increased risk of respiratory effects for everyone.</p>
                <h5>Solutions:</h5>
                <p>Stay indoors, use air purifiers, and limit outdoor activities.</p>
            </div>
        </div>
    </div>




    <script src="../static/js/pop_widow.js"></script> <!-- Ensure this file exists -->
    <script src="../static/js/ChatBot.js"></script>
    <script src="../static/js/EnterEmail.js"></script>
    <script src="../static/js/LatestAQIUpdate.js"></script>
    <script src="../static/js/CommunityForum.js"></script>
    <script src="../static/js/SuggestionsModal.js"></script>
    <script src="../static/js/Summarizer.js"></script>

    <script>

        // Event listener for form submission
document.getElementById('inputForm').addEventListener('submit', async function(event) {
    event.preventDefault();  // Prevent the default form submission

    // Get the input values
    const co = document.getElementById('co').value;
    const no = document.getElementById('no').value;
    const no2 = document.getElementById('no2').value;
    const so2 = document.getElementById('so2').value;
    const o3 = document.getElementById('o3').value;
    const nh3 = document.getElementById('nh3').value;

    // Prepare the data to send to the server
    const inputData = {
        co: co,
        no: no,
        no2: no2,
        so2: so2,
        o3: o3,
        nh3: nh3
    };

    try {
        // Make the fetch request to the backend
        const response = await fetch('/process_input_for_aqi', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify(inputData)
        });

        if (response.ok) {
            // Get JSON response from Flask
            const result = await response.json();

            // Log the result to check its structure
            console.log('Full response from Flask:', result);

            // Display the HTML message directly
            const resultElement = document.getElementById('result');
            if (resultElement) {
                resultElement.innerHTML = result.message;  // Use innerHTML to insert HTML content
                scrollToBottom_aqi();
            } else {
                console.error('Result element not found');
            }
        } else {
            document.getElementById('result').textContent = 'Error occurred while processing';
        }
    } catch (error) {
        console.error('Error:', error);
        document.getElementById('result').textContent = 'Error occurred while processing';
    }
});


    </script>

    <script>
        function scrollToBottom_aqi() {
            // Select the modal content within the modal
            const conversationHistory = document.querySelector('#manualInputModal .modal-content');

            // Check if the element exists to avoid errors
            if (conversationHistory) {
                // Scroll to the bottom of the modal content
                conversationHistory.scrollTop = conversationHistory.scrollHeight;
            } else {
                console.error('Element not found: #manualInputModal .modal-content');
            }
        }
    </script>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
        const modal = document.getElementById('EnterEmail');
        const closeModalBtn = document.getElementById('closeEmail');
        const form = document.getElementById('inputForm-for-email');
        const resultElement = document.getElementById('emailing-result').querySelector('span');

        // Close modal when the "x" button is clicked
        closeModalBtn.onclick = function() {
            modal.style.display = 'none';
        };

        // Handle form submission
        form.addEventListener('submit', function(event) {
            event.preventDefault(); // Prevent form from refreshing the page

            // Get the email input value
            const userEmail = document.getElementById('User_email').value;

            // Send the email to the Flask backend using POST
            fetch('/submit_email', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({ User_email: userEmail })
            })
            .then(response => response.json())
            .then(data => {
                // Display the result (Success or Failed) in the modal
                resultElement.innerHTML = data.message;
                resultElement.style.color = 'green';
            })
            .catch(error => {
                console.error('Error:', error);
                resultElement.innerHTML = 'Failed!';
                resultElement.style.color = 'red';
            });
        });

        // Optional: If you want the modal to close when clicked outside the modal content
        window.onclick = function(event) {
            if (event.target === modal) {
                modal.style.display = 'none';
            }
        };
    });

    </script>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
        const chatbotModal = document.getElementById('chatbotModal');
        const closeModalBtn = document.getElementById('closeModal');

        // Close modal when the "x" button is clicked
        closeModalBtn.onclick = function() {
            chatbotModal.style.display = 'none';
        };

        // Close modal when clicking outside the modal content
        window.onclick = function(event) {
            if (event.target === chatbotModal) {
                chatbotModal.style.display = 'none';
            }
        };
    });

    </script>


</body>
</html>
